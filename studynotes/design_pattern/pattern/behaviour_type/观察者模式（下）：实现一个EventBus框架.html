<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://aruni.me/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html"><meta property="og:site_name" content="AruNi's domain"><meta property="og:title" content="è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸‹ï¼‰ï¼šå®ç°ä¸€ä¸ª EventBus æ¡†æ¶"><meta property="og:description" content="æœ¬æ–‡å†…å®¹ å‰è¨€ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº† è§‚å¯Ÿè€…æ¨¡å¼æœ‰å‡ ç§ä¸åŒçš„å®ç°æ–¹å¼ï¼š åŒæ­¥é˜»å¡ï¼šç»å…¸å®ç°æ–¹å¼ï¼Œä¸»è¦ä¸ºäº†ä»£ç è§£è€¦ï¼› å¼‚æ­¥éé˜»å¡ï¼šé™¤äº†è§£è€¦å¤–ï¼Œä¹Ÿèƒ½æé«˜æ‰§è¡Œæ•ˆç‡ï¼› è¿›ç¨‹å†…ï¼šä¸Šé¢ä¸¤ç§å°±å±äºè¿›ç¨‹å†…ï¼Œåœ¨åŒä¸€ä¸ªç¨‹åºä¸­æ‰§è¡Œçš„ï¼› è¿›ç¨‹é—´ï¼šæ›´åŠ å½»åº•çš„è§£è€¦ï¼Œä¸€èˆ¬åŸºäº MQ å®ç°ã€‚ é‚£ä¹ˆæœ¬ç¯‡æ–‡ç« å°†èšç„¦äºå¼‚æ­¥éé˜»å¡çš„æ–¹å¼ï¼Œå®ç°ä¸€ä¸ªç±»ä¼¼ Google Guava EventBus çš„é€šç”¨æ¡†æ¶ï¼Œå¯¹è§‚å¯Ÿè€…æ¨¡å¼è¿›è¡Œå°è£…ï¼Œè®©å…¶åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ›´ç®€ä¾¿ã€‚ EventBus é¡¹ç›®åœ°å€ï¼šhttps://github.com/AruNi-01/DesignPattern/tree/main/dp/src/observer/eventbus Guava åœ°å€ï¼šhttps://github.com/google/guava ï¼Œç›´æ¥ä¸‹è½½ jar åŒ…æ·»åŠ è¿›è‡ªå®šä¹‰çš„ç›®å½•ï¼Œç„¶åå°†è¯¥ç›®å½• Add as Library å³å¯ä½¿ç”¨ï¼Œæˆ–è€…ä½¿ç”¨ Maven äº¦å¯ã€‚"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-06-22T13:56:53.000Z"><meta property="article:author" content="AruNi_Lu"><meta property="article:tag" content="è®¾è®¡æ¨¡å¼ä¸èŒƒå¼"><meta property="article:published_time" content="2023-06-18T00:00:00.000Z"><meta property="article:modified_time" content="2023-06-22T13:56:53.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸‹ï¼‰ï¼šå®ç°ä¸€ä¸ª EventBus æ¡†æ¶","image":[""],"datePublished":"2023-06-18T00:00:00.000Z","dateModified":"2023-06-22T13:56:53.000Z","author":[{"@type":"Person","name":"AruNi_Lu","url":"https://github.com/AruNi-01"}]}</script><link rel="icon" href="/logo.svg"><link rel="manifest" href="/docs/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><link rel="icon" href="/docs/logo.svg"><title>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸‹ï¼‰ï¼šå®ç°ä¸€ä¸ª EventBus æ¡†æ¶ | AruNi's domain</title><meta name="description" content="æœ¬æ–‡å†…å®¹ å‰è¨€ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº† è§‚å¯Ÿè€…æ¨¡å¼æœ‰å‡ ç§ä¸åŒçš„å®ç°æ–¹å¼ï¼š åŒæ­¥é˜»å¡ï¼šç»å…¸å®ç°æ–¹å¼ï¼Œä¸»è¦ä¸ºäº†ä»£ç è§£è€¦ï¼› å¼‚æ­¥éé˜»å¡ï¼šé™¤äº†è§£è€¦å¤–ï¼Œä¹Ÿèƒ½æé«˜æ‰§è¡Œæ•ˆç‡ï¼› è¿›ç¨‹å†…ï¼šä¸Šé¢ä¸¤ç§å°±å±äºè¿›ç¨‹å†…ï¼Œåœ¨åŒä¸€ä¸ªç¨‹åºä¸­æ‰§è¡Œçš„ï¼› è¿›ç¨‹é—´ï¼šæ›´åŠ å½»åº•çš„è§£è€¦ï¼Œä¸€èˆ¬åŸºäº MQ å®ç°ã€‚ é‚£ä¹ˆæœ¬ç¯‡æ–‡ç« å°†èšç„¦äºå¼‚æ­¥éé˜»å¡çš„æ–¹å¼ï¼Œå®ç°ä¸€ä¸ªç±»ä¼¼ Google Guava EventBus çš„é€šç”¨æ¡†æ¶ï¼Œå¯¹è§‚å¯Ÿè€…æ¨¡å¼è¿›è¡Œå°è£…ï¼Œè®©å…¶åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ›´ç®€ä¾¿ã€‚ EventBus é¡¹ç›®åœ°å€ï¼šhttps://github.com/AruNi-01/DesignPattern/tree/main/dp/src/observer/eventbus Guava åœ°å€ï¼šhttps://github.com/google/guava ï¼Œç›´æ¥ä¸‹è½½ jar åŒ…æ·»åŠ è¿›è‡ªå®šä¹‰çš„ç›®å½•ï¼Œç„¶åå°†è¯¥ç›®å½• Add as Library å³å¯ä½¿ç”¨ï¼Œæˆ–è€…ä½¿ç”¨ Maven äº¦å¯ã€‚">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/docs/assets/style-41739379.css" as="style"><link rel="stylesheet" href="/docs/assets/style-41739379.css">
    <link rel="modulepreload" href="/docs/assets/app-696d698e.js"><link rel="modulepreload" href="/docs/assets/framework-63f054a3.js"><link rel="modulepreload" href="/docs/assets/è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸‹ï¼‰ï¼šå®ç°ä¸€ä¸ªEventBusæ¡†æ¶.html-588f35be.js"><link rel="modulepreload" href="/docs/assets/è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸‹ï¼‰ï¼šå®ç°ä¸€ä¸ªEventBusæ¡†æ¶.html-8177bc86.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a href="/docs/" class="brand"><img class="logo light" src="/docs/logo.png" alt="AruNi&#39;s domain"><img class="logo dark" src="/docs/logo.png" alt="AruNi&#39;s domain"><span class="site-name hide-in-pad">AruNi&#39;s domain</span></a><!--]--><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><!--[--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/docs/studynotes/" class="nav-link active" aria-label="å­¦ä¹ ç¬”è®°"><span class="font-icon icon iconfont icon-Notes" style=""></span>å­¦ä¹ ç¬”è®°<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/lifetalk/" class="nav-link" aria-label="äººç”Ÿæ‚è°ˆ"><span class="font-icon icon iconfont icon-rensheng" style=""></span>äººç”Ÿæ‚è°ˆ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/updatelog/" class="nav-link" aria-label="æ›´æ–°æ—¥å¿—"><span class="font-icon icon iconfont icon-rizhi" style=""></span>æ›´æ–°æ—¥å¿—<!----></a></div><div class="nav-item hide-in-mobile"><a href="/docs/link/" class="nav-link" aria-label="é“¾æ¥åˆ†äº«"><span class="font-icon icon iconfont icon-link" style=""></span>é“¾æ¥åˆ†äº«<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://aruni.me" rel="noopener noreferrer" target="_blank" aria-label="æˆ‘çš„åšå®¢" class="nav-link"><span class="font-icon icon iconfont icon-blog" style=""></span>æˆ‘çš„åšå®¢<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--]--><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!--[--><div class="nav-item"><a class="repo-link" href="https://github.com/AruNi-01/" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢æ–‡æ¡£"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢æ–‡æ¡£</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-java" style=""></span><span class="title">Java</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-database" style=""></span><span class="title">æ•°æ®åº“</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-computer" style=""></span><span class="title">è®¡ç®—æœºåŸºç¡€</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-design-pattern" style=""></span><span class="title">è®¾è®¡æ¨¡å¼</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-mind" style=""></span><span class="title">è®¾è®¡åŸåˆ™ä¸æ€æƒ³</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><span class="font-icon icon iconfont icon-pattern" style=""></span><span class="title">è®¾è®¡æ¨¡å¼ä¸èŒƒå¼</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-create-type" style=""></span><span class="title">åˆ›å»ºå‹</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/create_type/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="å•ä¾‹æ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>å•ä¾‹æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/create_type/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="å·¥å‚æ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>å·¥å‚æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/create_type/%E5%BB%BA%E9%80%A0%E8%80%85%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="å»ºé€ è€…æ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>å»ºé€ è€…æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/create_type/%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="åŸå‹æ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>åŸå‹æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading"><span class="font-icon icon iconfont icon-structure-type" style=""></span><span class="title">ç»“æ„å‹</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/structure_type/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="ä»£ç†æ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>ä»£ç†æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/structure_type/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="æ¡¥æ¥æ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>æ¡¥æ¥æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/structure_type/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="è£…é¥°å™¨æ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>è£…é¥°å™¨æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/structure_type/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="é€‚é…å™¨æ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>é€‚é…å™¨æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/structure_type/%E9%97%A8%E9%9D%A2%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="é—¨é¢æ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>é—¨é¢æ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/structure_type/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="ç»„åˆæ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>ç»„åˆæ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/structure_type/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="äº«å…ƒæ¨¡å¼"><span class="font-icon icon iconfont icon-write" style=""></span>äº«å…ƒæ¨¡å¼<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><p class="sidebar-heading active"><span class="font-icon icon iconfont icon-behaviour-type" style=""></span><span class="title">è¡Œä¸ºå‹</span><!----></p><ul class="sidebar-links"><li><!--[--><a href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%A7%A3%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F.html" class="nav-link sidebar-link sidebar-page" aria-label="è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸Šï¼‰"><span class="font-icon icon iconfont icon-write" style=""></span>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸Šï¼‰<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸‹ï¼‰"><span class="font-icon icon iconfont icon-write" style=""></span>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸‹ï¼‰<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_1-å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="1. å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°"><!---->1. å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_2-guava-çš„-eventbus" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2. Guava çš„ EventBus"><!---->2. Guava çš„ EventBus<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_2-1-ä½¿ç”¨-eventbus" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.1 ä½¿ç”¨ EventBus"><!---->2.1 ä½¿ç”¨ EventBus<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_2-2-guava-eventbus-ä¸»è¦ç»„ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="2.2 Guava EventBus ä¸»è¦ç»„ä»¶"><!---->2.2 Guava EventBus ä¸»è¦ç»„ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_3-è‡ªå·±å®ç°ä¸€ä¸ª-eventbus-æ¡†æ¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3. è‡ªå·±å®ç°ä¸€ä¸ª EventBus æ¡†æ¶"><!---->3. è‡ªå·±å®ç°ä¸€ä¸ª EventBus æ¡†æ¶<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_3-1-eventbus-æ ¸å¿ƒç‚¹å‰–æ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.1 EventBus æ ¸å¿ƒç‚¹å‰–æ"><!---->3.1 EventBus æ ¸å¿ƒç‚¹å‰–æ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_3-2-eventbus-å…·ä½“å®ç°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="3.2 EventBus å…·ä½“å®ç°"><!---->3.2 EventBus å…·ä½“å®ç°<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li></ul></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-combat" style=""></span><span class="title">å¼€æºä¸é¡¹ç›®å®æˆ˜</span><span class="arrow end"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-fenbushi" style=""></span><span class="title">åˆ†å¸ƒå¼ç³»ç»Ÿ</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-microservice" style=""></span><span class="title">å¾®æœåŠ¡æ¶æ„</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-middleware" style=""></span><span class="title">ä¸­é—´ä»¶</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><span class="font-icon icon iconfont icon-framework" style=""></span><span class="title">æ¡†æ¶</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><span class="font-icon icon iconfont icon-write" style=""></span>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸‹ï¼‰ï¼šå®ç°ä¸€ä¸ª EventBus æ¡†æ¶</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/AruNi-01" target="_blank" rel="noopener noreferrer">AruNi_Lu</a></span><span property="author" content="AruNi_Lu"></span></span><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-06-18T00:00:00.000Z"></span><span class="page-word-info" aria-label="å­—æ•°ğŸ” " data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon word-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="word icon"><path d="M518.217 432.64V73.143A73.143 73.143 0 01603.43 1.097a512 512 0 01419.474 419.474 73.143 73.143 0 01-72.046 85.212H591.36a73.143 73.143 0 01-73.143-73.143z"></path><path d="M493.714 566.857h340.297a73.143 73.143 0 0173.143 85.577A457.143 457.143 0 11371.566 117.76a73.143 73.143 0 0185.577 73.143v339.383a36.571 36.571 0 0036.571 36.571z"></path></svg><span>çº¦ 3558 å­—</span><meta property="wordCount" content="3558"></span><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 12 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT12M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category2 clickable" role="navigation">è®¾è®¡æ¨¡å¼</span><!--]--><meta property="articleSection" content="è®¾è®¡æ¨¡å¼"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag2 clickable" role="navigation">è®¾è®¡æ¨¡å¼ä¸èŒƒå¼</span><!--]--><meta property="keywords" content="è®¾è®¡æ¨¡å¼ä¸èŒƒå¼"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_1-å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°" class="router-link-active router-link-exact-active toc-link level2">1. å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_2-guava-çš„-eventbus" class="router-link-active router-link-exact-active toc-link level2">2. Guava çš„ EventBus</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_2-1-ä½¿ç”¨-eventbus" class="router-link-active router-link-exact-active toc-link level3">2.1 ä½¿ç”¨ EventBus</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_2-2-guava-eventbus-ä¸»è¦ç»„ä»¶" class="router-link-active router-link-exact-active toc-link level3">2.2 Guava EventBus ä¸»è¦ç»„ä»¶</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_3-è‡ªå·±å®ç°ä¸€ä¸ª-eventbus-æ¡†æ¶" class="router-link-active router-link-exact-active toc-link level2">3. è‡ªå·±å®ç°ä¸€ä¸ª EventBus æ¡†æ¶</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_3-1-eventbus-æ ¸å¿ƒç‚¹å‰–æ" class="router-link-active router-link-exact-active toc-link level3">3.1 EventBus æ ¸å¿ƒç‚¹å‰–æ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_3-2-eventbus-å…·ä½“å®ç°" class="router-link-active router-link-exact-active toc-link level3">3.2 EventBus å…·ä½“å®ç°</a></li><!----><!--]--></ul></li><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><details class="hint-container details"><summary>æœ¬æ–‡å†…å®¹</summary><nav class="table-of-contents"><ul><li><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_1-å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°" class="router-link-active router-link-exact-active">1. å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°</a></li><li><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_2-guava-çš„-eventbus" class="router-link-active router-link-exact-active">2. Guava çš„ EventBus</a><ul><li><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_2-1-ä½¿ç”¨-eventbus" class="router-link-active router-link-exact-active">2.1 ä½¿ç”¨ EventBus</a></li><li><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_2-2-guava-eventbus-ä¸»è¦ç»„ä»¶" class="router-link-active router-link-exact-active">2.2 Guava EventBus ä¸»è¦ç»„ä»¶</a></li></ul></li><li><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_3-è‡ªå·±å®ç°ä¸€ä¸ª-eventbus-æ¡†æ¶" class="router-link-active router-link-exact-active">3. è‡ªå·±å®ç°ä¸€ä¸ª EventBus æ¡†æ¶</a><ul><li><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_3-1-eventbus-æ ¸å¿ƒç‚¹å‰–æ" class="router-link-active router-link-exact-active">3.1 EventBus æ ¸å¿ƒç‚¹å‰–æ</a></li><li><a aria-current="page" href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8B%EF%BC%89%EF%BC%9A%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AAEventBus%E6%A1%86%E6%9E%B6.html#_3-2-eventbus-å…·ä½“å®ç°" class="router-link-active router-link-exact-active">3.2 EventBus å…·ä½“å®ç°</a></li></ul></li></ul></nav></details><div class="hint-container info"><p class="hint-container-title">å‰è¨€</p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº† <strong>è§‚å¯Ÿè€…æ¨¡å¼æœ‰å‡ ç§ä¸åŒçš„å®ç°æ–¹å¼</strong>ï¼š</p><ul><li><strong>åŒæ­¥é˜»å¡</strong>ï¼šç»å…¸å®ç°æ–¹å¼ï¼Œä¸»è¦ä¸ºäº†ä»£ç è§£è€¦ï¼›</li><li><strong>å¼‚æ­¥éé˜»å¡</strong>ï¼šé™¤äº†è§£è€¦å¤–ï¼Œä¹Ÿèƒ½æé«˜æ‰§è¡Œæ•ˆç‡ï¼›</li><li><strong>è¿›ç¨‹å†…</strong>ï¼šä¸Šé¢ä¸¤ç§å°±å±äºè¿›ç¨‹å†…ï¼Œåœ¨åŒä¸€ä¸ªç¨‹åºä¸­æ‰§è¡Œçš„ï¼›</li><li><strong>è¿›ç¨‹é—´</strong>ï¼šæ›´åŠ å½»åº•çš„è§£è€¦ï¼Œä¸€èˆ¬åŸºäº MQ å®ç°ã€‚</li></ul><p>é‚£ä¹ˆæœ¬ç¯‡æ–‡ç« å°†èšç„¦äºå¼‚æ­¥éé˜»å¡çš„æ–¹å¼ï¼Œå®ç°ä¸€ä¸ªç±»ä¼¼ Google Guava EventBus çš„é€šç”¨æ¡†æ¶ï¼Œå¯¹è§‚å¯Ÿè€…æ¨¡å¼è¿›è¡Œå°è£…ï¼Œè®©å…¶åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ›´ç®€ä¾¿ã€‚</p><p>EventBus é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/AruNi-01/DesignPattern/tree/main/dp/src/observer/eventbus" target="_blank" rel="noopener noreferrer">https://github.com/AruNi-01/DesignPattern/tree/main/dp/src/observer/eventbus<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>Guava åœ°å€ï¼š<a href="https://github.com/google/guava" target="_blank" rel="noopener noreferrer">https://github.com/google/guava<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ï¼Œç›´æ¥ä¸‹è½½ jar åŒ…æ·»åŠ è¿›è‡ªå®šä¹‰çš„ç›®å½•ï¼Œç„¶åå°†è¯¥ç›®å½• Add as Library å³å¯ä½¿ç”¨ï¼Œæˆ–è€…ä½¿ç”¨ Maven äº¦å¯ã€‚</p></div><h2 id="_1-å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°" tabindex="-1"><a class="header-anchor" href="#_1-å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°" aria-hidden="true">#</a> 1. å¼‚æ­¥éé˜»å¡æ–¹å¼çš„ç®€æ˜“å®ç°</h2><p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æœ€ç®€å•çš„å¼‚æ­¥éé˜»å¡æ–¹å¼å®ç°çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼Œä¸ç”¨è€ƒè™‘é€šç”¨å‹ã€å¤ç”¨æ€§ç­‰ï¼Œå®ç°èµ·æ¥æ˜¯éå¸¸å®¹æ˜“çš„ã€‚</p><p>è¿˜æ˜¯æ‹¿ <a href="https://aruni.me/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%A7%A3%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F.html" target="_blank" rel="noopener noreferrer">è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸Šï¼‰ï¼šç†è§£è§‚å¯Ÿè€…æ¨¡å¼<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> ä¸­çš„ä¾‹å­è¯´æ˜ï¼Œæœ‰ä¸¤ç§å®ç°æ–¹å¼ï¼š</p><ul><li><p>åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å»æ‰§è¡Œæ¯ä¸ªç›‘å¬è€…éœ€è¦æ‰§è¡Œçš„æ–¹æ³•ï¼Œå…¶ä»–ä»£ç ä¸å˜ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">RegisterPromotionListener</span> <span class="token keyword">implements</span> <span class="token class-name">RegisterListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">PromotionService</span> promotionService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleRegisterSuccess</span><span class="token punctuation">(</span><span class="token keyword">long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œ</span>
        <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> promotionService<span class="token punctuation">.</span><span class="token function">issueNewUserExperienceCash</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åœ¨è¢«ç›‘å¬è€…è€…çš„ <code>notifyListeners()</code> æ–¹æ³•ä¸­ä½¿ç”¨çº¿ç¨‹æ± æ¥æ‰§è¡Œæ¯ä¸ªè§‚å¯Ÿè€…çš„æ–¹æ³•ï¼Œå…¶ä»–ä»£ç ä¸å˜ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// è§¦å‘å™¨ï¼ˆè¢«ç›‘å¬è€…ï¼‰</span>
<span class="token keyword">class</span> <span class="token class-name">RegisterDispatcher</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RegisterListener</span><span class="token punctuation">&gt;</span></span> listeners <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Executor</span> executor <span class="token operator">=</span> <span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addListener</span><span class="token punctuation">(</span><span class="token class-name">RegisterListener</span> listener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        listeners<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeListener</span><span class="token punctuation">(</span><span class="token class-name">RegisterListener</span> listener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        listeners<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">notifyListeners</span><span class="token punctuation">(</span><span class="token keyword">long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">RegisterListener</span> listener <span class="token operator">:</span> listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ä½¿ç”¨çº¿ç¨‹æ± å»æ‰§è¡Œè¯¥ä»»åŠ¡</span>
            executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> listener<span class="token punctuation">.</span><span class="token function">handleRegisterSuccess</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>ä¸Šé¢çš„å®ç°æ–¹å¼è™½ç„¶å¯è¡Œï¼Œä½† <strong>æ— æ³•åšåˆ°å¤ç”¨</strong>ï¼Œå¦‚æœæœ‰å¤šä¸ªä¸šåŠ¡æ¨¡å—éƒ½éœ€è¦ä½¿ç”¨åˆ°å¼‚æ­¥éé˜»å¡çš„è§‚å¯Ÿè€…æ¨¡å¼ï¼Œé‚£ä¹ˆæ¯ä¸ªä¸šåŠ¡æ¨¡å—éƒ½è¦å®ç°ä¸€éã€‚</p><p>å¦‚æœéœ€æ±‚æ›´æç«¯ä¸€ç‚¹ï¼Œæˆ‘ä»¬æƒ³è¦ <strong>åœ¨åŒæ­¥é˜»å¡å’Œå¼‚æ­¥éé˜»å¡ä¹‹é—´çµæ´»åˆ‡æ¢</strong>ï¼Œé‚£å°±è¦ <strong>ä¸åœåœ°ä¿®æ”¹å¯¹åº”çš„ä»£ç </strong>ï¼Œä¹Ÿä¸ç¬¦åˆ â€œå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­â€ åŸåˆ™</p><p>é‚£å¦‚ä½•è§£å†³å‘¢ï¼Ÿé€ ä¸ªè½®å­å‘—ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæ¡†æ¶çš„ä½œç”¨ä¸»è¦å°±æ˜¯ <strong>éšè—å®ç°ç»†èŠ‚ã€é™ä½å¼€å‘éš¾åº¦ã€åšåˆ°ä»£ç å¤ç”¨ã€è§£è€¦ä¸šåŠ¡ä¸éä¸šåŠ¡ä»£ç ï¼Œè®©ç¨‹åºå‘˜èšç„¦ä¸šåŠ¡çš„å¼€å‘</strong>ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å¼‚æ­¥éé˜»å¡çš„è§‚å¯Ÿè€…æ¨¡å¼æŠ½è±¡æˆä¸€ä¸ªæ¡†æ¶æ¥ä½¿ç”¨ï¼Œè¿™å°±æ˜¯æœ¬ç« è¦å®ç°çš„ EventBusã€‚</p><h2 id="_2-guava-çš„-eventbus" tabindex="-1"><a class="header-anchor" href="#_2-guava-çš„-eventbus" aria-hidden="true">#</a> 2. Guava çš„ EventBus</h2><h3 id="_2-1-ä½¿ç”¨-eventbus" tabindex="-1"><a class="header-anchor" href="#_2-1-ä½¿ç”¨-eventbus" aria-hidden="true">#</a> 2.1 ä½¿ç”¨ EventBus</h3><p><strong>EventBus</strong> æ„ä¸º â€œäº‹ä»¶æ€»çº¿â€ï¼Œå®ƒæä¾›äº† <strong>è§‚å¯Ÿè€…æ¨¡å¼çš„éª¨æ¶ä»£ç </strong>ï¼ŒåŸºäºå®ƒæˆ‘ä»¬èƒ½å¾ˆæ–¹ä¾¿çš„åœ¨ä¸šåŠ¡ä¸­ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼ã€‚</p><p>Google çš„ Guava EventBus æ˜¯ä¸€ä¸ªæ¯”è¾ƒè‘—åçš„ EventBus æ¡†æ¶ï¼Œå®ƒæ”¯æŒåŒæ­¥é˜»å¡å’Œå¼‚æ­¥éé˜»å¡æ¨¡å¼ã€‚</p><p>æˆ‘ä»¬è¿˜æ˜¯é€šè¿‡ä¸Šä¸€ç« çš„ä¾‹å­ï¼Œæ¥çœ‹çœ‹ Guava EventBus æœ‰å“ªäº›å¥½ç”¨çš„åŠŸèƒ½ã€‚Guava EventBus æ”¹é€ åçš„ä»£ç å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// æ— éœ€å®ç°ä»»ä½• Listener æ¥å£</span>
<span class="token keyword">class</span> <span class="token class-name">RegisterPromotionListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">PromotionService</span> promotionService<span class="token punctuation">;</span>

    <span class="token comment">// ä½¿ç”¨ @Subscribe å£°æ˜ç›‘å¬è€…</span>
    <span class="token annotation punctuation">@Subscribe</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleRegisterSuccess</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        promotionService<span class="token punctuation">.</span><span class="token function">issueNewUserExperienceCash</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">RegisterNotificationListener</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">NotificationService</span> notificationService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Subscribe</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleRegisterSuccess</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        notificationService<span class="token punctuation">.</span><span class="token function">sendInboxMessage</span><span class="token punctuation">(</span>userId<span class="token punctuation">,</span> <span class="token string">&quot;Welcome...&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">DEFAULT_EVENTBUS_THREAD_POOL_SIZE</span> <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token comment">// eventBus = new EventBus(); // åŒæ­¥é˜»å¡æ¨¡å¼</span>
    <span class="token keyword">private</span> <span class="token class-name">EventBus</span> eventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AsyncEventBus</span><span class="token punctuation">(</span><span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token constant">DEFAULT_EVENTBUS_THREAD_POOL_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">String</span> telephone<span class="token punctuation">,</span> <span class="token class-name">String</span> password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// çœç•¥è¾“å…¥å‚æ•°çš„æ ¡éªŒä»£ç </span>
        <span class="token comment">// çœç•¥ userService.register() å¼‚å¸¸çš„ try-catch ä»£ç </span>
        <span class="token keyword">long</span> userId <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>telephone<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">addListenerOfRegister</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// é€šè¿‡ eventBus.post æ´¾å‘æ¶ˆæ¯ï¼ˆè§¦å‘è¢« @Subscribe æ³¨è§£çš„æ–¹æ³•ï¼‰</span>
        eventBus<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> userId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ·»åŠ  Register ç›¸å…³çš„ Listenerï¼Œå®é™…åœºæ™¯å¯ä»¥æŠŠ List ä½œä¸ºå‚æ•°ï¼Œç”±å¤–éƒ¨è°ƒç”¨è€…å†³å®šè¦æ³¨å…¥ä»€ä¹ˆ Listener</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addListenerOfRegister</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> listeners <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        listeners<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegisterNotificationListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        listeners<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">RegisterPromotionListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setRegisterListeners</span><span class="token punctuation">(</span>listeners<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">// å‘ eventBus ä¸­æ³¨å†Œç›‘å¬è€…</span>
    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">setRegisterListeners</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> listener <span class="token operator">:</span> listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            eventBus<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ EventBus åï¼Œä¸ä¹‹å‰çš„æ–¹å¼ç›¸æ¯”ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹çš„å¼‚åŒï¼š</p><ul><li>éƒ½éœ€è¦ä½¿ç”¨ register æ–¹æ³•æ³¨å†Œ Listenerï¼š <ul><li>ä¹‹å‰çš„æ–¹å¼ï¼šä½¿ç”¨ä¸€ä¸ª List å®¹å™¨ä¿å­˜æ‰€æœ‰ Listenerï¼Œregister æ–¹æ³•å°±æ˜¯å‘ List ä¸­æ·»åŠ  Listenerï¼›</li><li>EventBusï¼šæ— éœ€å®¹å™¨ï¼Œç›´æ¥ä½¿ç”¨ eventBus çš„ register æ–¹æ³•å³å¯ã€‚</li></ul></li><li>éƒ½éœ€è¦è°ƒç”¨æŸä¸ªæ–¹æ³•é€šçŸ¥ Listenerï¼š <ul><li>ä¹‹å‰çš„æ–¹å¼ï¼šä½¿ç”¨ Dispatcher æä¾›çš„ notify æ–¹æ³•ï¼ˆéå† Listï¼Œæ‰§è¡Œ Listener çš„ä¸šåŠ¡é€»è¾‘ï¼‰ï¼›</li><li>EventBusï¼šä½¿ç”¨ eventBus çš„ post æ–¹æ³•å³å¯ã€‚</li></ul></li><li><strong>åŸºäº EventBus æ— éœ€å®šä¹‰ Listener æ¥å£</strong>ï¼Œä»»æ„ç±»å‹çš„å¯¹è±¡éƒ½å¯ä»¥æ³¨å†Œåˆ° EventBus ä¸­ï¼Œé€šè¿‡ <code>@Subscribe</code> æ¥æ ‡æ˜ã€‚</li></ul><h3 id="_2-2-guava-eventbus-ä¸»è¦ç»„ä»¶" tabindex="-1"><a class="header-anchor" href="#_2-2-guava-eventbus-ä¸»è¦ç»„ä»¶" aria-hidden="true">#</a> 2.2 Guava EventBus ä¸»è¦ç»„ä»¶</h3><p>ä¸‹é¢æ¥çœ‹çœ‹ Guava EventBus ä¸­çš„ä¸»è¦ç±»å’Œå‡½æ•°ã€‚</p><div class="hint-container tip"><p class="hint-container-title">EventBusã€AsyncEventBus</p><p>Guava EventBus å¯¹å¤–æš´éœ²çš„æ‰€æœ‰æ¥å£éƒ½å°è£…åœ¨ EventBus ç±»ä¸­ï¼Œå…¶ä¸­ï¼š</p><ul><li><strong>EventBus æ˜¯åŒæ­¥é˜»å¡çš„è§‚å¯Ÿè€…æ¨¡å¼</strong>ï¼›</li><li><strong>AsyncEventBus</strong> ç»§æ‰¿è‡ª EventBusï¼Œæä¾›äº† <strong>å¼‚æ­¥éé˜»å¡çš„è§‚å¯Ÿè€…æ¨¡å¼</strong>ã€‚</li></ul><p>å…·ä½“ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">EventBus</span> eventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// åŒæ­¥é˜»å¡æ¨¡å¼</span>
<span class="token class-name">EventBus</span> eventBus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AsyncEventBus</span><span class="token punctuation">(</span><span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">newFixedThreadPool</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>ï¼›<span class="token comment">// å¼‚æ­¥é˜»å¡æ¨¡å¼</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div><div class="hint-container tip"><p class="hint-container-title">register() å‡½æ•°</p><p>EventBus ä½¿ç”¨ <strong><code>register()</code> æ¥æ³¨å†Œè§‚å¯Ÿè€…</strong>ã€‚å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å®ƒå¯ä»¥æ¥å— <strong>ä»»ä½•ç±»å‹ï¼ˆObjectï¼‰çš„è§‚å¯Ÿè€…</strong>ã€‚è€Œç»å…¸å®ç°æ–¹å¼ä¸­ï¼Œ<code>register()</code> æ¥å—çš„ç±»å¯¹è±¡å¿…é¡»è¦å®ç°æŸåŒä¸€çˆ¶è§‚å¯Ÿè€…æ¥å£ã€‚</p></div><div class="hint-container tip"><p class="hint-container-title">unregister() å‡½æ•°</p><p>ä¸ä¸Šé¢çš„ <code>register()</code> ç›¸å¯¹ï¼Œç”¨æ¥ <strong>ä» EventBus ä¸­åˆ é™¤ä¸€ä¸ªè§‚å¯Ÿè€…</strong>ï¼Œå‡½æ•°ç­¾åå¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">unregister</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div><div class="hint-container tip"><p class="hint-container-title">post() å‡½æ•°</p><p>EventBus ä½¿ç”¨ <strong><code>post()</code> å‡½æ•°ç»™è§‚å¯Ÿè€…å‘é€æ¶ˆæ¯</strong>ï¼Œå‡½æ•°ç­¾åå¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token class-name">Object</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸ç»å…¸çš„è§‚å¯Ÿè€…æ¨¡å¼ä¸åŒï¼Œå½“è°ƒç”¨ <code>post()</code> å‡½æ•°å‘é€æ¶ˆæ¯æ—¶ï¼Œå¹¶ä¸æ˜¯å‘é€ç»™æ‰€æœ‰çš„è§‚å¯Ÿè€…ï¼Œè€Œæ˜¯ <strong>å‘é€ç»™å¯åŒ¹é…çš„è§‚å¯Ÿè€…</strong>ï¼Œå¯åŒ¹é…æŒ‡ <strong>èƒ½æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹æ˜¯å‘é€æ¶ˆæ¯ï¼ˆpost å‡½æ•°ä¸­å®šä¹‰çš„ eventï¼‰ç±»å‹çš„åŒç±»æˆ–çˆ¶ç±»</strong>ã€‚</p><p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ä½ å°±æ‡‚äº†ã€‚å‡å¦‚ï¼š</p><ul><li>Listener_A èƒ½æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹æ˜¯ Msg_Aï¼›</li><li>Listener_B èƒ½æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹æ˜¯ Msg_Bï¼›</li><li>Listener_C èƒ½æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹æ˜¯ Msg_Cï¼›</li></ul><p>å…¶ä¸­ï¼š</p><ul><li>Msg_A æ˜¯ Msg_B çš„çˆ¶ç±»ã€‚</li></ul><p>å½“å‘é€æ¶ˆæ¯æ—¶ï¼Œèƒ½æ¥æ”¶åˆ°æ¶ˆæ¯çš„å¯åŒ¹é…è§‚å¯Ÿè€…æƒ…å†µå¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Listener_A</span> <span class="token punctuation">{</span>
    <span class="token comment">// Listener_A èƒ½æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹æ˜¯ Msg_A</span>
	<span class="token annotation punctuation">@Subscribe</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Msg_A</span> msgA<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token comment">// ......</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Listener_B</span> <span class="token punctuation">{</span>
    <span class="token comment">// Listener_B èƒ½æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹æ˜¯ Msg_Bï¼Œä½† Msg_B ç»§æ‰¿è‡ª Msg_Aï¼Œæ‰€ä»¥æ­¤æ—¶ Listener_A ä¹Ÿèƒ½æ”¶åˆ°æ¶ˆæ¯</span>
	<span class="token annotation punctuation">@Subscribe</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Msg_B</span> msgB<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token comment">// ......</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// Listener_C å’Œ Msg_Aã€Msg_Bã€Msg_C çš„å®šä¹‰ç•¥</span>

<span class="token comment">// ä½¿ç”¨</span>
<span class="token class-name">Msg_A</span> <span class="token class-name">MsgA</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Msg_A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Msg_B</span> <span class="token class-name">MsgB</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Msg_B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Msg_C</span> <span class="token class-name">MsgC</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Msg_C</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">post</span><span class="token punctuation">(</span><span class="token class-name">MsgA</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// =&gt; Listener_A æ¥æ”¶åˆ°æ¶ˆæ¯</span>
<span class="token function">post</span><span class="token punctuation">(</span><span class="token class-name">MsgB</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// =&gt; Listener_Aã€Listener_B æ¥æ”¶åˆ°æ¶ˆæ¯</span>
<span class="token function">post</span><span class="token punctuation">(</span><span class="token class-name">MsgC</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// =&gt; Listener_C æ¥æ”¶åˆ°æ¶ˆæ¯</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¹Ÿå°±æ˜¯è¯´ post å‡½æ•° <strong>ä¸ä»…ä¼šæŠŠæ¶ˆæ¯å‘é€ç»™è¯¥æ¶ˆæ¯æ‰€å¯¹åº”çš„ Listenerï¼Œè¿˜ä¼šå‘ç»™è¯¥æ¶ˆæ¯ç±»å‹çš„çˆ¶ç±»å¯¹åº”çš„ Listener</strong>ã€‚</p><p>æ¯ä¸ª Listener èƒ½æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹å°±æ˜¯ç”¨ <code>@Subscribe</code> æ³¨è§£æ ‡æ˜ã€‚</p></div><div class="hint-container tip"><p class="hint-container-title">@Subscribe æ³¨è§£</p><p>EventBus é€šè¿‡ <strong><code>@Subscribe</code> æ³¨è§£æ ‡æ˜æŸä¸ªå‡½æ•°èƒ½æ¥æ”¶å“ªç§ç±»å‹çš„æ¶ˆæ¯</strong>ã€‚å…·ä½“ä½¿ç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ListenerA</span> <span class="token punctuation">{</span>
    <span class="token comment">//...çœç•¥å…¶ä»–å±æ€§å’Œæ–¹æ³•...</span>

    <span class="token annotation punctuation">@Subscribe</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token class-name">PMsg</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//... }</span>

    <span class="token annotation punctuation">@Subscribe</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token class-name">QMsg</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//... }</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>EventBus æ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><strong>é€šè¿‡ <code>register()</code> å‡½æ•°å°† ListenerA ç±»å¯¹è±¡æ³¨å†Œè¿› EventBus æ—¶ï¼ŒEventBus ä¼šæ ¹æ® <code>@Subscribe</code> æ³¨è§£æ‰¾åˆ° <code>f1()</code> å’Œ <code>f2()</code>ï¼Œå¹¶å°†ä¸¤ä¸ªå‡½æ•°èƒ½æ¥æ”¶çš„æ¶ˆæ¯ç±»å‹è®°å½•ä¸‹æ¥</strong>ï¼ˆPMsg -&gt; f1ï¼ŒQMsg -&gt; f2ï¼‰ï¼›</li><li><strong>é€šè¿‡ <code>post(Object event)</code> å‘é€æ¶ˆæ¯æ—¶ï¼ŒEventBus ä¼šé€šè¿‡ä¹‹å‰çš„è®°å½•ï¼ˆæ¶ˆæ¯ç±»å‹ -&gt; å‡½æ•°ï¼‰ï¼Œæ ¹æ®å‚æ•° event è°ƒç”¨ç›¸åº”çš„å‡½æ•°</strong>ã€‚</li></ol><p>æ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨ Guava EventBus æ—¶ï¼Œä¸€èˆ¬éƒ½ä¼šå®šä¹‰è‡ªå·±çš„ eventï¼Œç„¶åä½¿ç”¨ Listener è¿›è¡Œè®¢é˜…ï¼ˆç›‘å¬ï¼‰eventï¼Œç­‰å¾…æ¶ˆæ¯çš„å‘é€ï¼ˆä½¿ç”¨ postï¼‰ã€‚</p></div><p>å‚è€ƒ Guava EventBus çš„è®¾è®¡ï¼Œæˆ‘ä»¬ä¸‹é¢å°±æ¥ç®€å•çš„å®ç°ä¸€ä¸‹æˆ‘ä»¬è‡ªå·±çš„ EventBusã€‚</p><h2 id="_3-è‡ªå·±å®ç°ä¸€ä¸ª-eventbus-æ¡†æ¶" tabindex="-1"><a class="header-anchor" href="#_3-è‡ªå·±å®ç°ä¸€ä¸ª-eventbus-æ¡†æ¶" aria-hidden="true">#</a> 3. è‡ªå·±å®ç°ä¸€ä¸ª EventBus æ¡†æ¶</h2><h3 id="_3-1-eventbus-æ ¸å¿ƒç‚¹å‰–æ" tabindex="-1"><a class="header-anchor" href="#_3-1-eventbus-æ ¸å¿ƒç‚¹å‰–æ" aria-hidden="true">#</a> 3.1 EventBus æ ¸å¿ƒç‚¹å‰–æ</h3><p>é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥å‘ç° EventBus ä¸­æœ€æ ¸å¿ƒçš„å°±æ˜¯ <strong><code>register()</code> å’Œ <code>post()</code></strong> çš„å®ç°ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæ¥åˆ†æä¸‹è¿™ä¸¤ä¸ªå‡½æ•°å¦‚ä½•å®ç°ã€‚</p><p>ä¸‹é¢æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°çš„å®ç°åŸç†å›¾ï¼š</p><p><img src="https://run-notes.oss-cn-beijing.aliyuncs.com/notes/202306181741954.png" alt="image-20230618174104603" loading="lazy"></p><p>å¯ä»¥å‘ç°ï¼Œä¸¤ä¸ªå‡½æ•°éƒ½ä½¿ç”¨åˆ°äº† <strong>Observer æ³¨å†Œè¡¨ï¼Œå®ƒè®°å½•äº†æ¶ˆæ¯ç±»å‹å’Œå¯æ¥æ”¶å‡½æ•°çš„å¯¹åº”å…³ç³»</strong>ï¼š</p><ul><li>å½“è°ƒç”¨ <code>register()</code> æ³¨å†Œè§‚å¯Ÿè€…æ—¶ï¼ŒEventBus é€šè¿‡è§£æ <code>@Sebscribe</code> æ³¨è§£ï¼Œç”Ÿæˆ Observer æ³¨å†Œè¡¨ï¼›</li><li>å½“è°ƒç”¨ <code>post()</code> å‘é€æ¶ˆæ¯æ—¶ï¼ŒEventBus é€šè¿‡æ³¨å†Œè¡¨æ‰¾åˆ°ç›¸åº”çš„å¯æ¥æ”¶æ¶ˆæ¯çš„å‡½æ•°ï¼Œç„¶åé€šè¿‡åå°„æ¥åŠ¨æ€åœ°åˆ›å»ºå¯¹è±¡ã€æ‰§è¡Œç›¸åº”çš„å‡½æ•°ã€‚</li></ul><p>è€Œå¯¹äºåŒæ­¥é˜»å¡å’Œå¼‚æ­¥éé˜»å¡çš„å®ç°ï¼Œå”¯ä¸€çš„å·®å¼‚åªåœ¨äºï¼šæ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹å†…ä¾æ¬¡æ‰§è¡Œç›¸åº”çš„å‡½æ•°ï¼Œè¿˜æ˜¯ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹æ± æ¥æ‰§è¡Œã€‚</p><h3 id="_3-2-eventbus-å…·ä½“å®ç°" tabindex="-1"><a class="header-anchor" href="#_3-2-eventbus-å…·ä½“å®ç°" aria-hidden="true">#</a> 3.2 EventBus å…·ä½“å®ç°</h3><p>é€šè¿‡äº†ä¸Šé¢çš„åŸç†åˆ†æï¼Œä¸‹é¢çš„å®ç°å°±æ¯”è¾ƒç®€å•äº†ï¼Œæ•´ä¸ª EventBus ç”± 5 ä¸ªç±»ç»„æˆï¼šEventBusã€AsyncEventBusã€Subscribeã€ObserverActionã€ObserverRegistryã€‚</p><div class="hint-container tip"><p class="hint-container-title">Subscribe</p></div><p>SubScribe æ˜¯ä¸€ä¸ªæ³¨è§£ï¼Œç”¨äº <strong>æ ‡æ˜è§‚å¯Ÿè€…ä¸­çš„å“ªä¸ªå‡½æ•°å¯ä»¥æ¥å—æ¶ˆæ¯</strong>ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@desc</span>: ç”¨äºæ ‡æ˜è§‚å¯Ÿè€…ä¸­çš„å“ªä¸ªå‡½æ•°å¯ä»¥æ¥å—æ¶ˆæ¯
 * æ³¨è§£ @Beta æ˜¯ Guava ä¸­ä¸€ä¸ªè¡¨ç¤ºå¤„äº Beta é˜¶æ®µçš„ APIï¼ˆæ— å½±å“ï¼‰
 * <span class="token keyword">@author</span>: AruNi_Lu
 * <span class="token keyword">@date</span>: 2023-06-18
 */</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span><span class="token class-name">RetentionPolicy</span><span class="token punctuation">.</span><span class="token constant">RUNTIME</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span><span class="token class-name">ElementType</span><span class="token punctuation">.</span><span class="token constant">METHOD</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Beta</span>
<span class="token keyword">public</span> <span class="token annotation punctuation">@interface</span> <span class="token class-name">Subscribe</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">ObserverAction</p></div><p><strong>ObserverAction ç±»ç”¨æ¥è¡¨ç¤º <code>@Subscribe</code> æ³¨è§£çš„æ–¹æ³•</strong>ï¼Œå…¶ä¸­ï¼š</p><ul><li>target è¡¨ç¤ºè§‚å¯Ÿè€…ç±»ï¼›</li><li>method è¡¨ç¤ºè§‚å¯Ÿè€…ç±»ä¸­çš„æ–¹æ³•ã€‚</li></ul><p>è¯¥ç±»ä¸»è¦ç”¨åœ¨ ObserverRegistry çš„ Observer æ³¨å†Œè¡¨ä¸­ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@desc</span>: ç”¨æ¥è¡¨ç¤º @Subscribe æ³¨è§£çš„æ–¹æ³•
 * <span class="token keyword">@author</span>: AruNi_Lu
 * <span class="token keyword">@date</span>: 2023-06-18
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ObserverAction</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> target<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Method</span> method<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ObserverAction</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// Preconditions.checkNotNull() ç”± google.common.base æä¾›</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkNotNull</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>method <span class="token operator">=</span> method<span class="token punctuation">;</span>

        <span class="token comment">// æš´åŠ›ç ´è§£ï¼Œä½¿å…¶å…·æœ‰ç›´æ¥è®¿é—®å’Œä¿®æ”¹ç§æœ‰å…ƒç´ çš„èƒ½åŠ›</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">setAccessible</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * æ‰§è¡Œæ–¹æ³•
     * <span class="token keyword">@param</span> <span class="token parameter">event</span> method æ–¹æ³•çš„å‚æ•°
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Object</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> event<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IllegalAccessException</span> <span class="token operator">|</span> <span class="token class-name">InvocationTargetException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">ObserverRegistry</p></div><p>ObserverRegistry ç±»å°±æ˜¯ Observer æ³¨å†Œè¡¨ï¼Œä¹Ÿæ˜¯æœ€å¤æ‚çš„ä¸€ä¸ªç±»ï¼Œæ¡†æ¶ä¸­çš„æ ¸å¿ƒé€»è¾‘éƒ½åœ¨è¿™ä¸ªç±»ä¸­ã€‚</p><p>è¯¥ç±»å¤§é‡ä½¿ç”¨äº† Java çš„åå°„è¯­æ³•ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå·§å¦™çš„ CopyOnWriteArraySet çš„ä½¿ç”¨ã€‚</p><blockquote><p><strong>CopyOnWriteArraySet</strong> ä½¿ç”¨çš„æ˜¯ <strong>å†™æ—¶å¤åˆ¶æŠ€æœ¯</strong>ï¼Œç”¨æ¥è§£å†³ <strong>è¯»å†™æ—¶çš„å¹¶å‘é—®é¢˜</strong>ã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œåœ¨å†™å…¥æ•°æ®æ—¶ï¼Œä¼šåˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„ setï¼Œç„¶åå°†åŸå§‹æ•°æ® clone åˆ°æ–°çš„ set ä¸­ï¼Œåœ¨æ–°çš„ set ä¸­è¿›è¡Œå†™æ“ä½œï¼Œè¿™æ ·å°±ä¸ä¼šå½±å“è¯»æ“ä½œã€‚ç­‰æ–°çš„ set ä¸­å†™å…¥æ•°æ®å®Œæˆåï¼Œå†ç”¨æ–°çš„ set æ›¿æ¢è€çš„ set å³å¯ã€‚</p><p>ä¸ç”¨æ‹…å¿ƒå¹¶å‘å†™é—®é¢˜ï¼Œå› ä¸º <strong>CopyOnWriteArraySet ä¼šé€šè¿‡åŠ é”çš„æ–¹å¼é¿å…å¹¶å‘å†™é—®é¢˜</strong>ã€‚</p></blockquote><p>è¯¥ç±»çš„å®ç°å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@desc</span>: Observer æ³¨å†Œè¡¨
 * <span class="token keyword">@author</span>: AruNi_Lu
 * <span class="token keyword">@date</span>: 2023-06-18
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ObserverRegistry</span> <span class="token punctuation">{</span>

    <span class="token comment">// Observer æ³¨å†Œè¡¨</span>
    <span class="token keyword">private</span> <span class="token class-name">ConcurrentMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">CopyOnWriteArraySet</span><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> registry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ³¨å†Œ observer
     * <span class="token keyword">@param</span> <span class="token parameter">observer</span> observer ç±»
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">Object</span> observer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–è¯¥ observer ç±»çš„æ‰€æœ‰ ObserverAction</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> observerActions <span class="token operator">=</span> <span class="token function">findAllObserverActions</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// éå†æ‰€æœ‰ ObserverActionï¼Œæ·»åŠ åˆ° registry</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> observerActions<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> eventType <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span></span> eventActions <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            
            <span class="token class-name">CopyOnWriteArraySet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span></span> registeredEventActions <span class="token operator">=</span> registry<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>eventType<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// åˆå§‹åŒ–ï¼Œé¿å…å¹¶å‘åœºæ™¯ä¸‹å‡ºç°é”™è¯¯</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>registeredEventActions <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                registry<span class="token punctuation">.</span><span class="token function">putIfAbsent</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">CopyOnWriteArraySet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                registeredEventActions <span class="token operator">=</span> registry<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>eventType<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            registeredEventActions<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>eventActions<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * è·å–ä¸è¯¥ event å‘åŒ¹é…çš„æ‰€æœ‰ ObserverActionï¼ˆå‘é€æ¶ˆæ¯ç±»å‹çš„åŒç±»æˆ–çˆ¶ç±»ï¼‰
     * <span class="token keyword">@param</span> <span class="token parameter">event</span> event
     * <span class="token keyword">@return</span> æ‰€æœ‰ ObserverAction
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span></span> <span class="token function">getMatchedObserverActions</span><span class="token punctuation">(</span><span class="token class-name">Object</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span></span> matchedObservers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> postedEventType <span class="token operator">=</span> event<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Map<span class="token punctuation">.</span>Entry</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">CopyOnWriteArraySet</span><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> entry <span class="token operator">:</span> registry<span class="token punctuation">.</span><span class="token function">entrySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> eventType <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">CopyOnWriteArraySet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span></span> eventActions <span class="token operator">=</span> entry<span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// åˆ¤æ–­ eventType æ˜¯å¦ç”± postedEventType æ´¾ç”Ÿè€Œæ¥ï¼Œæ˜¯è¯´æ˜è¯¥ eventType å¯¹åº”çš„ eventActions ç¬¦åˆæ¡ä»¶</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>eventType<span class="token punctuation">.</span><span class="token function">isAssignableFrom</span><span class="token punctuation">(</span>postedEventType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                matchedObservers<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>eventActions<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> matchedObservers<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * è·å–è¯¥ observer ç±»çš„æ‰€æœ‰ ObserverAction
     * <span class="token keyword">@param</span> <span class="token parameter">observer</span> observer ç±»
     * <span class="token keyword">@return</span> æ‰€æœ‰ eventType å’Œå…¶å¯¹åº”çš„ ObserverAction
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAllObserverActions</span><span class="token punctuation">(</span><span class="token class-name">Object</span> observer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Class</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">,</span> <span class="token class-name">Collection</span><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> observerActions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz <span class="token operator">=</span> observer<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è·å–è¯¥ç±»æ‰€æœ‰ä½¿ç”¨äº† @Subscribe æ ‡æ³¨çš„æ–¹æ³•ï¼Œéå†å°†å…¶æ·»åŠ è¿› observerActions</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> method <span class="token operator">:</span> <span class="token function">getAnnotatedMethods</span><span class="token punctuation">(</span>clazz<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> parameterTypes <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> eventType <span class="token operator">=</span> parameterTypes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

            <span class="token comment">// åˆå§‹åŒ–</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>observerActions<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>eventType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                observerActions<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>eventType<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            observerActions<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>eventType<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ObserverAction</span><span class="token punctuation">(</span>observer<span class="token punctuation">,</span> method<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> observerActions<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * è·å–è¯¥ç±»ä½¿ç”¨äº† @Subscribe æ ‡æ³¨çš„æ–¹æ³•
     * <span class="token keyword">@param</span> <span class="token parameter">clazz</span> ç±»
     * <span class="token keyword">@return</span> ç¬¦åˆæ¡ä»¶çš„æ–¹æ³•é›†åˆ
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Method</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAnnotatedMethods</span><span class="token punctuation">(</span><span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> clazz<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Method</span><span class="token punctuation">&gt;</span></span> annotatedMethods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Method</span> method <span class="token operator">:</span> clazz<span class="token punctuation">.</span><span class="token function">getDeclaredMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// åˆ¤æ–­è¯¥æ–¹æ³•æ˜¯å¦ç”¨äº† @Subscribe æ ‡æ³¨</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">isAnnotationPresent</span><span class="token punctuation">(</span><span class="token class-name">Subscribe</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> parameterTypes <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">getParameterTypes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// æ–¹æ³•çš„å‚æ•°å¿…é¡»åªæœ‰ä¸€ä¸ª</span>
                <span class="token class-name">Preconditions</span><span class="token punctuation">.</span><span class="token function">checkArgument</span><span class="token punctuation">(</span>parameterTypes<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">,</span>
                        <span class="token string">&quot;Method %s has @Subscribe annotation but has %s parameters.&quot;</span>
                                <span class="token operator">+</span> <span class="token string">&quot;Subscriber methods must have exactly 1 parameter.&quot;</span><span class="token punctuation">,</span>
                        method<span class="token punctuation">,</span> parameterTypes<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
                annotatedMethods<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> annotatedMethods<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">EventBus</p></div><p>EventBus çš„å®ç°æ˜¯åŒæ­¥é˜»å¡çš„ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹Ÿä½¿ç”¨åˆ°äº†çº¿ç¨‹æ±  Executorï¼Œå› ä¸ºè¿™æ ·å¯ä»¥åšåˆ°ä»£ç å¤ç”¨ï¼Œå¾ˆå®¹æ˜“å°±å®ç°äº†åé¢çš„ AsyncEventBusï¼ˆå¯ä»¥ç›´æ¥ç»§æ‰¿ EventBusï¼‰ã€‚</p><blockquote><p><code>MoreExecutors.directExecutor()</code> æ˜¯ Google Guava æä¾›çš„å·¥å…·ç±»ï¼Œè¯¥ Executor å®é™…ä¸Šæ˜¯å•çº¿ç¨‹ã€‚</p></blockquote><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@desc</span>: åŒæ­¥é˜»å¡çš„è§‚å¯Ÿè€…æ¨¡å¼
 * <span class="token keyword">@author</span>: AruNi_Lu
 * <span class="token keyword">@date</span>: 2023-06-18
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EventBus</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Executor</span> executor<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">ObserverRegistry</span> registry <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObserverRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">EventBus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// MoreExecutors.directExecutor()ï¼ŒGuava æä¾›çš„å•çº¿ç¨‹ Executor</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token class-name">MoreExecutors</span><span class="token punctuation">.</span><span class="token function">directExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token class-name">EventBus</span><span class="token punctuation">(</span><span class="token class-name">Executor</span> executor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>executor <span class="token operator">=</span> executor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token class-name">Object</span> object<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        registry<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token class-name">Object</span> event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–æ¶ˆæ¯å¯åŒ¹é…çš„å‡½æ•°</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ObserverAction</span><span class="token punctuation">&gt;</span></span> observerActions <span class="token operator">=</span> registry<span class="token punctuation">.</span><span class="token function">getMatchedObserverActions</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ObserverAction</span> observerAction <span class="token operator">:</span> observerActions<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            executor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> observerAction<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">AsyncEventBus</p></div><p>AsyncEventBus çš„å®ç°å°±éå¸¸ç®€å•äº†ï¼Œç»§æ‰¿ EventBusï¼Œç›´æ¥ä»å¤–éƒ¨ä¼ è¿›æ¥ä¸€ä¸ª Executorï¼Œå†è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨å³å¯ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * <span class="token keyword">@desc</span>: å¼‚æ­¥éé˜»å¡çš„è§‚å¯Ÿè€…æ¨¡å¼
 * <span class="token keyword">@author</span>: AruNi_Lu
 * <span class="token keyword">@date</span>: 2023-06-18
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AsyncEventBus</span> <span class="token keyword">extends</span> <span class="token class-name">EventBus</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">AsyncEventBus</span><span class="token punctuation">(</span><span class="token class-name">Executor</span> executor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>executor<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ°æ­¤ï¼Œä¸€ä¸ªç®€æ˜“çš„ Eventbus æ¡†æ¶å°±å®Œæˆäº†ï¼Œå¯ä»¥å°†ä¸Šé¢ Guava EventBus çš„ç±»å…¨éƒ¨æ›¿æ¢æˆæˆ‘ä»¬è‡ªå·±å†™çš„ï¼Œæ¥æµ‹è¯•ä¸‹çœ‹çœ‹æ•ˆæœæ˜¯å¦ä¸€æ ·ã€‚</p><p>å½“ç„¶äº†ï¼Œåœ¨ç»†èŠ‚æ–¹é¢ï¼ŒGuava åšäº†å¾ˆå¤šä¼˜åŒ–ï¼Œæ¯”å¦‚åœ¨æ³¨å†Œè¡¨ä¸­æŸ¥æ‰¾æ¶ˆæ¯å¯åŒ¹é…å‡½æ•°çš„ç®—æ³•ï¼Œè¿™äº›å¯ä»¥å» Guava æºç ä¸­å­¦ä¹ ã€‚</p></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><!----></div></footer><nav class="page-nav"><a href="/docs/studynotes/design_pattern/pattern/behaviour_type/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F%EF%BC%88%E4%B8%8A%EF%BC%89%EF%BC%9A%E7%90%86%E8%A7%A3%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F.html" class="nav-link prev" aria-label="è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸Šï¼‰"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon iconfont icon-write" style=""></span>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆä¸Šï¼‰</div></a><!----></nav><div class="giscus-wrapper input-top" id="comment" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><!----></div><!--]--><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/docs/assets/app-696d698e.js" defer></script>
  </body>
</html>
